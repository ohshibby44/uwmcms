{{ attach_library('uwmed/clinic-hours') }}


{% import directory ~'/templates/node/node--uwm-clinic.hours.html.twig' as _clinicHours %}

<div class="row">
    {% for clinic in locations %}


        <div class="col-xs-12 col-xl-6 provider-location">

            <div class="col-xs-12 col-sm-5 location-image">
                {% set src = clinic.externalUrl|replace({'http://': 'https://'}) ~ '/PublishingImages/splash1.jpg' %}
                {% set image = uwm_render_remote_image(src, 'medium') %}
                {#@TODO: Use clinic node's image#}
                {{ image }}
            </div>

            <div class="col-xs-12 col-sm-7">

                <h4 class="location-title">
                    {% if clinic.clinicUrl %}
                        <a href="{{ clinic.clinicUrl }}">{{ clinic.clinicName }}</a>
                    {% elseif clinic.externalUrl %}
                        <a href="{{ clinic.externalUrl }}">{{ clinic.clinicName }}</a>
                    {% endif %}
                </h4>

                <address class="location-address k">
                    <i class="uw-ico clinic_locations"></i>
                    {{ clinic.address }}
                    {{ clinic.city }},
                    {{ clinic.state }}
                    {{ clinic.zipcode }}
                </address>

                <p class="location-phone k">
                    {% if clinic.seoPhone %}
                        <i class="uw-ico call_solid"></i>
                        {% set phone = clinic.seoPhone|slice(0, 3)
                        ~'-'~ clinic.seoPhone|slice(3, 3)
                        ~'-'~ clinic.seoPhone|slice(6, 4) %}
                        <a href="tel:{{ phone }}">{{ phone|replace({'-': '.'}) }}</a>
                    {% endif %}
                </p>

                <p class="location-services k">
                    {% if clinic.expertises %}
                        <i class="uw-ico checkmark"></i>
                        {{ uwm_extract_parts(clinic, 'expertiseName')|slice(0, 4)|uwm_join_parts(', ') }}
                    {% endif %}
                </p>

                <div class="location-hours k">
                    {% set nid = uwm_get_api_nid(clinic.url) %}
                    {% set hours = clinic.clinicTimeUseMasters[0].hoursOfOperation %}
                    {% if hours and nid %}
                        {{ _clinicHours.uwOpensNextSnippet_withRefresh(hours, nid) }}
                    {% endif %}
                </div>

            </div>

        </div>

    {% endfor %}
</div>